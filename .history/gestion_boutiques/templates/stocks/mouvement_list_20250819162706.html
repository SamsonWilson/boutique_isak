<!-- templates/stock/mouvement_list.html -->


<div class="container mt-4">
    <h1 class="mb-4">Mouvements du produit : {{ produit.nom }}</h1>

    <!-- Filtre date -->
    <form method="get" class="row g-3 mb-4">
        <div class="col-md-4">
            <label>Date début</label>
            <input type="date" name="date_debut" class="form-control" value="{{ request.GET.date_debut }}">
        </div>
        <div class="col-md-4">
            <label>Date fin</label>
            <input type="date" name="date_fin" class="form-control" value="{{ request.GET.date_fin }}">
        </div>
        <div class="col-md-4 d-flex align-items-end">
            <button type="submit" class="btn btn-primary me-2">Filtrer</button>
            <button onclick="window.print()" type="button" class="btn btn-success">Imprimer</button>
        </div>
    </form>

    <div class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Date</th>
                    <th>Boutique</th>
                    <th>Type</th>
                    <th>Quantité</th>
                    <th>Utilisateur</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
            {% for mv in mouvements %}
                <tr>
                    <td>{{ mv.date_mouvement|date:"d/m/Y H:i" }}</td>
                    <td>{{ mv.boutique.nom }}</td>
                    <td>
                        {% if mv.type_mouvement == "entrée" %}
                            <span class="badge bg-success">{{ mv.type_mouvement }}</span>
                        {% else %}
                            <span class="badge bg-danger">{{ mv.type_mouvement }}</span>
                        {% endif %}
                    </td>
                    <td>{{ mv.quantite }}</td>
                    <td>{{ mv.utilisateur.username|default:"-" }}</td>
                    <td>{{ mv.description|default:"-" }}</td>
                </tr>
            {% empty %}
                <tr><td colspan="6" class="text-center">Aucun mouvement</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
@media print {
    form, button, a { display: none !important; }
    table { page-break-inside: avoid; }
}
</style>